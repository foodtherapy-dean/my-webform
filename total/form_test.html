<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì›”ë³„ ë°ì´í„° ì·¨í•©</title>
      <!- í™ˆí™”ë©´ ë°”ë¡œê°€ê¸°ìš© ì•„ì´ì½˜ ì§€ì • ->
<link rel="icon" type="image/png" sizes="192x192" href="total.png">
<link rel="apple-touch-icon" href="total.png">
<meta name="theme-color" content="#4CAF50">
<!-- PWA (í™ˆí™”ë©´ ì„¤ì¹˜ì‹œ ì•„ì´ì½˜ ë° ì´ë¦„ ì§€ì •) -->
<link rel="manifest" href="manifest.json">
  <style>
    body{font-family:Arial,Helvetica,sans-serif;margin:16px}
    .controls{display:flex;gap:8px;align-items:center}
    select, button{padding:6px 10px;font-size:14px}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{border:1px solid #ccc;padding:6px;text-align:center}
    th{background:#f5f5f5}
    .small{font-size:13px;color:#666}
    .loading{margin-left:8px;font-size:13px}

 /* ìš”ì¼ í—¤ë” ì „ì²´ */
th:nth-child(2) {
  background: #eeeeee !important; /* ì˜…ì€ íšŒìƒ‰ */
}

/* ìš”ì¼ ì—´ ì „ì²´ */
td.weekday {
  background: #f5f5f5;  /* ì˜…ì€ íšŒìƒ‰ */
}

/* ì¼ìš”ì¼ ì¤„ */
tr.sunday {
  background: #ffecec;  /* ì—°í•œ ë¹¨ê°• ê³„ì—´ */
}

/* í† ìš”ì¼ ì¤„ */
tr.saturday {
  background: #e9f2ff;  /* ì—°í•œ íŒŒë‘ ê³„ì—´ */
}

/* ğŸ”— í—¤ë” ë§í¬ ìŠ¤íƒ€ì¼ */
th a {
  color: inherit; 
  text-decoration: none; 
  display: block; 
  width: 100%;
  height: 100%;
}

  </style>
</head>
<body>
  <h2>ì›”ë³„ ë°ì´í„° ì·¨í•©</h2>
  <div class="controls">
    <label for="monthSelector">ì›” ì„ íƒ: </label>
    <select id="monthSelector"></select>
    <button id="prevBtn">&lt;</button>
    <button id="nextBtn">&gt;</button>
    <span id="statusText" class="loading"></span>
  </div>

  <table id="statusTable">
    <thead>
      <tr>
        <th>ì¼</th>
        <th>ìš”ì¼</th>

        <th><a href="https://foodtherapy-dean.github.io/my-webform/wash/form_wash.html" target="_blank">ìœ„ìƒ</a></th>
        <th><a href="https://foodtherapy-dean.github.io/my-webform/noodle/form_noodle.html" target="_blank">ê±´ë©´</a></th>
        <th><a href="https://foodtherapy-dean.github.io/my-webform/wnoodle/form_Wnoodle.html" target="_blank">ìƒë©´</a></th>
        <th><a href="https://foodtherapy-dean.github.io/my-webform/magnet/form_magnet.html" target="_blank">ê¸ˆì†</a></th>
        <th><a href="https://foodtherapy-dean.github.io/my-webform/input/form_input.html" target="_blank">ì…ê³ </a></th>
        <th><a href="https://foodtherapy-dean.github.io/my-webform/bug/form_bug.html" target="_blank">ë°©ì¬</a></th>
        <th><a href="https://foodtherapy-dean.github.io/my-webform/water/form_water.html" target="_blank">ê¸‰ìˆ˜</a></th>

      </tr>
    </thead>
    <tbody></tbody>
  </table>

<script>
  // ë°°í¬ URL(ì‚¬ìš©ì ì œê³µ)
  const BASE_URL = "https://script.google.com/macros/s/AKfycbzdMxsyB2_HzncC4Ru9ROVX_R14PyByHeOIFTAGtmiZ2Tuow3BxE30sh5L_LVm6leQG0Q/exec";

  const monthSel = document.getElementById("monthSelector");
  const statusText = document.getElementById("statusText");

  function init() {
    populateMonths();
    document.getElementById("prevBtn").addEventListener("click", () => changeMonth(-1));
    document.getElementById("nextBtn").addEventListener("click", () => changeMonth(1));
    monthSel.addEventListener("change", loadSelectedMonth);
    setToCurrentMonth();
  }

  function populateMonths() {
    const today = new Date();
    const thisYear = today.getFullYear();
    const startYear = thisYear - 1;
    const endYear = thisYear + 1;
    for (let y = startYear; y <= endYear; y++) {
      for (let m = 1; m <= 12; m++) {
        const opt = document.createElement("option");
        const val = `${y}-${String(m).padStart(2,"0")}`;
        opt.value = val;
        opt.textContent = `${y}ë…„ ${m}ì›”`;
        monthSel.appendChild(opt);
      }
    }
  }

  function setToCurrentMonth() {
    const t = new Date();
    const v = `${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,'0')}`;
    monthSel.value = v;
    loadSelectedMonth();
  }

  function changeMonth(delta) {
    const [y, m] = monthSel.value.split("-").map(Number);
    let newY = y, newM = m + delta;
    if (newM < 1) { newM = 12; newY -= 1; }
    if (newM > 12) { newM = 1; newY += 1; }
    const val = `${newY}-${String(newM).padStart(2,'0')}`;
    monthSel.value = val;
    loadSelectedMonth();
  }

  async function loadSelectedMonth() {
    const val = monthSel.value;
    const [year, month] = val.split("-").map(Number);
    statusText.textContent = "ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...";
    try {
      const url = `${BASE_URL}?mode=data&year=${year}&month=${month}`;
      const resp = await fetch(url);
      const json = await resp.json();
      if (!json.success) throw new Error(json.error || "ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨");
      renderTable(json.data);
      statusText.textContent = `ì™„ë£Œ â€” ${year}ë…„ ${month}ì›”`;
    } catch (err) {
      statusText.textContent = "ì˜¤ë¥˜: " + (err.message || err);
      document.querySelector("#statusTable tbody").innerHTML = "";
      console.error(err);
    }
  }

  function renderTable(data) {
    const tbody = document.querySelector("#statusTable tbody");
    tbody.innerHTML = "";
    const weekDays = ["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];

    data.forEach(item => {
      const dt = new Date(item.date);
      const day = dt.getDate();
      const w = weekDays[dt.getDay()];

      const tr = document.createElement("tr");

      if (w === "ì¼") tr.classList.add("sunday");
      if (w === "í† ") tr.classList.add("saturday");

      tr.innerHTML = `
        <td>${day}</td>
        <td class="weekday">${w}</td>
        ${item.status.map(s => `<td>${s}</td>`).join("")}
      `;
      tbody.appendChild(tr);
    });
  }

  window.onload = init;
</script>
</body>
</html>
